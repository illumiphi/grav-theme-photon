{% set page_title = header.title ~ ' | ' ~ site.title %}
{% set page_description = page.summary|striptags|rtrim|regex_replace( '/\n/', ' - ' ) %}
{% set featured_image = base_url_absolute ~ page.url ~ '/' ~ page.header.featured_image %}
{% block head %}

<head>
<!-- {{ theme.color.key }} -->
<title>{{ page_title }}</title>
<!-- test -->
<!-- meta -->
{% block meta %}
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {% if page.summary %}
  <meta name="description" content="{{ page_description }}">
  {% else %}
  <meta name="description" content="{{ site.description }}">
  {% endif %}
  {% if header.robots %}
  <meta name="robots" content="{{ header.robots }}">
  {% endif %}
{% endblock meta %}

<!-- favicon -->
{% block favicon %}
  {#- TODO put favicon in config #}
  <link rel="icon"  href="/images/favicon.png">
{% endblock favicon %}

<!-- rss -->
{% block rss %}
  <link rel="alternate" href="{{ page.url ~ '.rss' }}" title="{{ page_title }}" type="application/atom+xml">
{% endblock rss %}

<!-- schema -->
{% block schema %}
{% include '_json-ld/article.html.twig'  %}
{% include "_json-ld/#{ page.template }.html.twig" ignore missing %}
{% endblock schema %}

<!-- opengraph -->
{% block opengraph %}
<meta property="og:title" content="{{ page_title }}">
<meta property="og:description" content="{{ page_description }}">
<meta property="og:image" content="{{ featured_image }}">
<meta property="og:url" content="{{ page.url }}">
<meta name="twitter:card" content="{{ featured_image }}">
{% endblock opengraph %}

{% block stylesheets %}
{% do assets.add('theme://css/photon.css', {priority:50, group:'photon'} ) %}
{% endblock %}

<!-- CSS photon -->
{{ assets.css('photon') }}
<!-- CSS photon-plugins -->
{{ assets.css('photon-plugins') }}
<!-- CSS  -->
{{ assets.css() }}

{% block javascripts %}
{%- do assets.add( 'https://code.jquery.com/jquery-3.2.1.slim.min.js',
  {'priority':1001} ) %}
{% if browser.getBrowser == 'msie' and browser.getVersion >= 8 and browser.getVersion <= 9 %}
{% do assets.add('https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js',
  {'priority':101, 'loading':'defer'} ) %}
{% do assets.add('https://oss.maxcdn.com/respond/1.4.2/respond.min.js',
  {'priority':101, 'loading':'defer'} ) %}
{% endif %}
{%- do assets.add('https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.3/TweenMax.min.js',
  {'priority':101, 'loading':'defer'} ) %}
{%- do assets.addJs('theme://js/article.js',
  {'priority':200, 'pipeline':false, 'loading':'defer', 'group':'photon' }) %}
{%- do assets.addJs('theme://js/showcase.js',
  {'priority':300, 'pipeline':false, 'loading':'defer', 'group':'photon' }) %}
{% endblock javascripts %}

<!-- JS -->
{{ assets.js() }}
<!-- JS photon -->
{{ assets.js('photon') }}
<!-- JS photon-plugins -->
{{ assets.js('photon-plugins') }}

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://uicdn.toast.com/tui.code-snippet/latest/tui-code-snippet.min.js"></script>
<script type="text/javascript" src="https://uicdn.toast.com/tui.time-picker/latest/tui-time-picker.min.js"></script>
<script type="text/javascript" src="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chance/1.0.13/chance.min.js"></script>

</head>
{% endblock head %}
